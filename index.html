<script>
const series=["1¬∫ Per√≠odo","2¬∫ Per√≠odo","1¬∫ Ano","2¬∫ Ano","3¬∫ Ano","4¬∫ Ano","5¬∫ Ano","6¬∫ Ano","7¬∫ Ano","8¬∫ Ano","9¬∫ Ano"];
const disciplinas=["L√≠ngua Portuguesa","Matem√°tica","Hist√≥ria","Geografia","Artes","Religi√£o","Ci√™ncias","L√≠ngua Inglesa","Educa√ß√£o F√≠sica"];

series.forEach(s=>{contSerie.innerHTML+=`<option>${s}</option>`;qSerie.innerHTML+=`<option>${s}</option>`})
disciplinas.forEach(d=>{contDisc.innerHTML+=`<option>${d}</option>`;qDisc.innerHTML+=`<option>${d}</option>`})

function showSection(id){
document.querySelectorAll(".container").forEach(c=>c.classList.remove("active"))
document.getElementById(id).classList.add("active")
carregarTudo()
}

function loginAdmin(){
let senha=prompt("Senha do administrador:")
if(senha==="1234"){showSection("adminPanel");listarAdmin()}else{alert("Senha incorreta")}
}

/* ---------- IN√çCIO ---------- */
function salvarInicio(){
localStorage.setItem("inicioTexto",inicioTexto.value)
let midias=[]
for(let f of inicioMidia.files){midias.push(URL.createObjectURL(f))}
localStorage.setItem("inicioMidia",JSON.stringify(midias))
carregarInicio()
}
function carregarInicio(){
inicioConteudo.innerHTML="<p>"+(localStorage.getItem("inicioTexto")||"")+"</p>"
let midias=JSON.parse(localStorage.getItem("inicioMidia")||"[]")
midias.forEach(m=>{
if(m.includes("video")) inicioConteudo.innerHTML+=`<video src="${m}" controls width="300"></video>`
else inicioConteudo.innerHTML+=`<img src="${m}" width="300">`
})
}

/* ---------- CONTE√öDOS ---------- */
function salvarConteudo(){
let lista=JSON.parse(localStorage.getItem("conteudos")||"[]")
lista.push({titulo:contTitulo.value,serie:contSerie.value,disc:contDisc.value,desc:contDesc.value})
localStorage.setItem("conteudos",JSON.stringify(lista))
alert("Conte√∫do salvo")
listarAdmin()
carregarTudo()
}

function editarConteudo(i){
let lista=JSON.parse(localStorage.getItem("conteudos")||"[]")
let c=lista[i]
contTitulo.value=c.titulo
contSerie.value=c.serie
contDisc.value=c.disc
contDesc.value=c.desc
lista.splice(i,1)
localStorage.setItem("conteudos",JSON.stringify(lista))
listarAdmin()
}

function excluirConteudo(i){
let lista=JSON.parse(localStorage.getItem("conteudos")||"[]")
lista.splice(i,1)
localStorage.setItem("conteudos",JSON.stringify(lista))
listarAdmin()
carregarTudo()
}

/* ---------- QUEST√ïES ---------- */
function salvarQuestao(){
let lista=JSON.parse(localStorage.getItem("questoes")||"[]")
lista.push({tipo:qTipo.value,serie:qSerie.value,disc:qDisc.value,pergunta:qPergunta.value,A:aA.value,B:aB.value,C:aC.value,D:aD.value,correta:qCorreta.value})
localStorage.setItem("questoes",JSON.stringify(lista))
alert("Quest√£o salva")
listarAdmin()
carregarTudo()
}

function editarQuestao(i){
let lista=JSON.parse(localStorage.getItem("questoes")||"[]")
let q=lista[i]
qTipo.value=q.tipo
qSerie.value=q.serie
qDisc.value=q.disc
qPergunta.value=q.pergunta
aA.value=q.A
aB.value=q.B
aC.value=q.C
aD.value=q.D
qCorreta.value=q.correta
lista.splice(i,1)
localStorage.setItem("questoes",JSON.stringify(lista))
listarAdmin()
}

function excluirQuestao(i){
let lista=JSON.parse(localStorage.getItem("questoes")||"[]")
lista.splice(i,1)
localStorage.setItem("questoes",JSON.stringify(lista))
listarAdmin()
carregarTudo()
}

/* ---------- LISTAS NO SITE ---------- */
function carregarTudo(){
carregarInicio()
let c=JSON.parse(localStorage.getItem("conteudos")||"[]")
listaConteudos.innerHTML=""
c.forEach(i=>listaConteudos.innerHTML+=`<div class='question'><b>${i.titulo}</b><br>${i.serie} - ${i.disc}<br>${i.desc}</div>`)

let q=JSON.parse(localStorage.getItem("questoes")||"[]")
listaAtividades.innerHTML="";listaSimulados.innerHTML="";listaAde.innerHTML="";listaSaeb.innerHTML=""
q.forEach(i=>{
let bloco=`<div class='question'><b>${i.pergunta}</b><br>A) ${i.A}<br>B) ${i.B}<br>C) ${i.C}<br>D) ${i.D}</div>`
if(i.tipo==="Atividade") listaAtividades.innerHTML+=bloco
if(i.tipo==="Simulado") listaSimulados.innerHTML+=bloco
if(i.tipo==="ADE") listaAde.innerHTML+=bloco
if(i.tipo==="SAEB") listaSaeb.innerHTML+=bloco
})
}

/* ---------- LISTAGEM ADMIN ---------- */
function listarAdmin(){
let area=document.getElementById("adminLista")
if(!area){
area=document.createElement("div")
area.id="adminLista"
adminPanel.appendChild(area)
}

let c=JSON.parse(localStorage.getItem("conteudos")||"[]")
let q=JSON.parse(localStorage.getItem("questoes")||"[]")

area.innerHTML="<h3>Conte√∫dos Cadastrados</h3>"
c.forEach((i,idx)=>{
area.innerHTML+=`${i.titulo} (${i.serie}) 
<button class='small-btn' onclick='editarConteudo(${idx})'>‚úèÔ∏è</button>
<button class='small-btn' onclick='excluirConteudo(${idx})'>üóëÔ∏è</button><br>`
})

area.innerHTML+="<h3>Quest√µes Cadastradas</h3>"
q.forEach((i,idx)=>{
area.innerHTML+=`${i.tipo} - ${i.pergunta} 
<button class='small-btn' onclick='editarQuestao(${idx})'>‚úèÔ∏è</button>
<button class='small-btn' onclick='excluirQuestao(${idx})'>üóëÔ∏è</button><br>`
})
}

/* ---------- BACKUP ---------- */
function backupDados(){
let dados={inicioTexto:localStorage.getItem("inicioTexto"),inicioMidia:localStorage.getItem("inicioMidia"),conteudos:localStorage.getItem("conteudos"),questoes:localStorage.getItem("questoes")}
let blob=new Blob([JSON.stringify(dados)],{type:"application/json"})
let a=document.createElement("a")
a.href=URL.createObjectURL(blob)
a.download="backup_paula_educa.json"
a.click()
}

function restaurarBackup(e){
let file=e.target.files[0]
let reader=new FileReader()
reader.onload=function(){
let dados=JSON.parse(reader.result)
for(let k in dados)localStorage.setItem(k,dados[k])
carregarTudo();listarAdmin()
alert("Backup restaurado")
}
reader.readAsText(file)
}

carregarTudo()
</script>
